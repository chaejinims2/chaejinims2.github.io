<header class="app-topbar navbar navbar-expand-lg" aria-label="Top">
  <div class="app-top-left">

    <button type="button" class="app-sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
      <span class="app-nav-ico app-nav-ico--svg" style="--ico: url('{{ site.baseurl }}/assets/svg/bars-3-solid.svg');" aria-hidden="true"></span>
    </button>
    <a class="app-title" href="/">
      <!-- <img class="app-title-logo" src="{{ site.baseurl }}/assets/images/logo.png" alt="{{ site.title }}" /> -->
      <span class="app-title-text">{{ site.title }}</span>
    </a>
  </div>
  <div class="d-flex align-items-center gap-2 app-top-right" id="topbarNav">
    <div class="collapse navbar-collapse" style="flex: 1;">
      <nav class="app-topmenu">
        {% assign url_parts = page.url | split: "/" %}
        {% if url_parts[1] == "public" %}
          {% assign page_group = url_parts[2] %}
        {% elsif url_parts[1] == "protected" %}
          {% assign page_group = url_parts[2] %}
        {% else %}
          {% assign page_group = url_parts[1] %}
        {% endif %}
        {% assign section_pages = site.pages | where: "layout", "section" | where_exp: "item", "item.url contains '/protected/'" | sort: "url" %}
        {% for section_page in section_pages %}
          {% assign group_base = section_page.url %}
          {% assign segs = section_page.url | split: "/" %}
          {% assign group_key = segs[2] %}
          {% comment %} protected URL: /protected/XXX/ â†’ group_key = XXX {% endcomment %}
          {% assign group_title = section_page.title | default: group_key | capitalize %}
          {% unless section_page.hide %}
          {% assign nav_icon_name = section_page.icon | default: "book" %}
          <a class="app-topmenu-item {% if page_group == group_key %}active{% endif %}" href="{{ group_base }}" title="{{ group_title }}" aria-label="{{ group_title }}">
            <span class="app-nav-ico app-nav-ico--svg" style="--ico: url('{{ site.baseurl }}/assets/svg/{{ nav_icon_name }}-solid.svg');" aria-hidden="true"></span>
            <span class="app-topmenu-label">{{ group_title }}</span>
          </a>
          {% endunless %}
        {% endfor %}
      </nav>
    </div>
  </div>
</header>
